---
description: AI rules derived by SpecStory from the project AI interaction history
globs: *
---

## PROJECT RULES &amp; GUIDELINES
<headers/>

## TECH STACK
*   Go (version 1.21 or later)
*   Temporal.io Go SDK
*   Bubbletea TUI Framework
*   Charmbracelet Lipgloss

## PROJECT DOCUMENTATION &amp; CONTEXT SYSTEM
*   The project includes comprehensive documentation.
*   Use code comments and descriptions to clearly explain the purpose and function of different code sections.
*   Keep documentation up-to-date with any changes to the codebase.

## CODING STANDARDS
*   Follow Go coding conventions and best practices.
*   Write clean, modular, and well-documented code.
*   Use descriptive names for variables, functions, and methods.
*   Adhere to the project's architectural principles, emphasizing separation of concerns and domain-driven design.

## WORKFLOW &amp; RELEASE RULES
*   All code changes must be reviewed before being merged.
*   Implement comprehensive unit and integration tests for all new features.

## DEBUGGING
*   Use logging and debugging tools to identify and resolve issues.

## TUI DESIGN PRINCIPLES
*   The TUI should be aesthetically pleasing and easy to navigate.
*   Use clear and concise language in the user interface.
*   Provide helpful tooltips and documentation to guide users.
* When implementing the TUI, make sure to use a modern aesthetic design with better colors, borders, and visual hierarchy. Aim for a beautiful theme system with a modern aesthetic (Catppuccin-inspired).
* Redesign the TUI with stunning visuals: header, footer, borders, gradients.

## ERROR HANDLING
*   Implement robust error handling to prevent unexpected crashes.
*   Log errors and provide informative error messages to the user.

## CODE ANALYSIS
*   During the code analysis phase, focus on identifying Temporal workflows and activities.
* The tool should identify:
    * Workflows
    * Activities
    * Signals
    * Queries
    * Updates
    * Timers
    * Versioning
    * Search Attributes
    * Continue-as-New
*   During the code analysis phase, focus on identifying Temporal workflow and activity calls within a function.

## DEPENDENCY MANAGEMENT
*   Use Go modules to manage project dependencies.
*   Keep dependencies up-to-date.

## EXPORT FUNCTIONALITY
* The tool should be able to export the analysis in multiple formats, including:
    * JSON
    * DOT (Graphviz)
    * Mermaid
    * Markdown

## NAVIGATION
* Ensure the TUI navigation flow is intuitive.

## FILTERING
* In the list view, initially prioritize showing only top-level workflows (those with no parents).
* The initial view should only show top-level workflows from the tree.
* The initial view should only show top-level workflows from the tree.
* Provide options to toggle the visibility of activities, signals, and other components.
* The `/` search function should not shift the layout down, and should react to typing.
* When a filter is active, it should be visually clear in the TUI.

## INTERNAL CALLS
* The tool should also track "internal" non-Temporal function calls within Activities
* The TUI should display Internal Calls, and also enable drill-down navigation into those function definitions
* When viewing a node's details and pressing Enter on an internal call, dynamically parse the source file at runtime to find what functions that internal call invokes. Only attempt to navigate to local functions.

## THEME
* Follow the defined theme.

## GENERAL BEHAVIOR
* The TUI should mostly always also show "calls" and "called by" in the details view.
* The details view should always show "Calls" and "Called By" sections, even if they're empty
* The TUI should mostly always also show "calls" and "called by" in the details view.

## GENERAL NOTES
* Add new views: Stats dashboard, Graph visualization, Help overlay.
* Implement a keyboard shortcut system with a help panel.
* Add workflow search with fuzzy matching.
* Create export functionality (DOT, Mermaid, Markdown).
* The tool should be able to export the analysis in multiple formats, including DOT (Graphviz), Mermaid, and Markdown.
* The TUI should be aesthetically pleasing and easy to navigate.
* Use clear and concise language in the user interface.
* Provide helpful tooltips and documentation to guide users.
* Implement robust error handling to prevent unexpected crashes.
* Log errors and provide informative error messages to the user.
* In the details view, show internal calls (non-Temporal function calls) within Activities.
* In the tree view, provide options to group the workflow by package or call hierarchy.
* In the tree view, show internal calls (non-Temporal function calls) within Activities.
* In the tree view, provide options to group the workflow by package or call hierarchy.
* In the tree view, "by package" should use FQNs (grouping by common parent), otherwise it's too many.